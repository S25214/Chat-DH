:root {
    --bg-color: #0f172a;
    --sidebar-bg: #1e293b;
    --panel-bg: rgba(30, 41, 59, 0.7);
    --border-color: #334155;
    --primary-color: #8b5cf6;
    --primary-hover: #7c3aed;
    --text-primary: #f8fafc;
    --text-secondary: #94a3b8;
    --input-bg: #334155;
    --user-msg-bg: #8b5cf6;
    --bot-msg-bg: #334155;
    --danger-color: #ef4444;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-color);
    color: var(--text-primary);
    height: 100dvh;
    height: 100dvh;
    overflow: hidden;
}

/* Ensure sidebar toggle button is hidden on mobile mobile.css usually handles mobile layout overrides, 
   but we can enforce it here via media query or specific class logic if needed. 
   However, the user asked "not for the mobile page".
   The mobile view uses a different layout (absolute sidebar). 
   Let's check if we should hide the button in general mobile view.
*/
@media (max-width: 768px) {
    #sidebar-toggle-btn {
        display: none !important;
    }
}

/* App Layout */
.app-container {
    display: flex;
    height: 100dvh;
}

.sidebar {
    width: 280px;
    background-color: var(--sidebar-bg);
    border-right: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    padding: 1rem;
    transition: width 0.3s ease;
    overflow-x: hidden;
    /* Ensure content doesn't spill when collapsing */
}

/* Sidebar Collapsed State */
/* Sidebar Collapsed State - Desktop Only */
@media (min-width: 769px) {
    .sidebar.collapsed {
        width: 60px;
        padding: 1rem 0.5rem;
    }

    .sidebar.collapsed .sidebar-header h2,
    .sidebar.collapsed #settings-btn,
    .sidebar.collapsed .bot-info,
    .sidebar.collapsed .primary-btn {
        display: none !important;
    }

    .sidebar.collapsed .sidebar-header {
        justify-content: center;
        margin-bottom: 1rem;
    }

    .sidebar.collapsed .bot-item {
        justify-content: center;
        padding: 0.5rem;
    }

    .sidebar.collapsed .bot-avatar {
        margin-right: 0;
    }

    .sidebar.collapsed .bot-list {
        margin-bottom: 0.5rem;
    }

    .sidebar.collapsed #create-bot-btn {
        display: flex !important;
        justify-content: center;
        width: 40px;
        height: 40px;
        padding: 0;
        border-radius: 50%;
        margin: 0 auto;
        font-size: 0;
    }

    .sidebar.collapsed #create-bot-btn i {
        font-size: 1rem;
        margin: 0;
    }

    .sidebar.collapsed #create-bot-btn span {
        display: none;
    }
}

.chat-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    position: relative;
    background: radial-gradient(circle at top right, #1e1b4b, #0f172a);
    min-width: 0;
}

/* Sidebar Components */
.sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.bot-list {
    flex: 1;
    overflow-y: auto;
    margin-bottom: 1rem;
}

.bot-item {
    display: flex;
    align-items: center;
    padding: 0.75rem;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: background-color 0.2s;
    margin-bottom: 0.5rem;
}

.bot-item:hover {
    background-color: rgba(255, 255, 255, 0.05);
}

.bot-item.active {
    background-color: var(--primary-color);
}

.bot-avatar {
    width: 40px;
    height: 40px;
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.2rem;
    margin-right: 0.75rem;
    flex-shrink: 0;
}

.bot-info h4 {
    font-size: 0.95rem;
    font-weight: 500;
}

.bot-info p {
    font-size: 0.8rem;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
}

.bot-item.active .bot-info p {
    color: rgba(255, 255, 255, 0.8);
}

/* Buttons */
.primary-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.primary-btn:hover {
    background-color: var(--primary-hover);
}

.full-width {
    width: 100%;
}

#dh-connect-btn {
    min-width: 80px;
    white-space: nowrap;
}

.icon-btn {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 1.1rem;
    padding: 0.5rem;
    border-radius: 50%;
    transition: color 0.2s, background-color 0.2s;
}

.icon-btn:hover {
    color: var(--text-primary);
    background-color: rgba(255, 255, 255, 0.1);
}

.icon-btn.danger:hover {
    color: var(--danger-color);
    background-color: rgba(239, 68, 68, 0.1);
}

.danger-btn {
    background-color: rgba(239, 68, 68, 0.1);
    border: 1px solid var(--danger-color);
    color: var(--danger-color);
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.danger-btn:hover {
    background-color: var(--danger-color);
    color: white;
}

/* Chat Area */
.empty-state {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100%;
    color: var(--text-secondary);
    text-align: center;
}

.empty-state i {
    font-size: 4rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.chat-interface {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.chat-header {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: rgba(15, 23, 42, 0.8);
    backdrop-filter: blur(10px);
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.chat-bot-info {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.bot-avatar.large {
    width: 48px;
    height: 48px;
    font-size: 1.5rem;
}

.status {
    font-size: 0.8rem;
    color: #4ade80;
}

.messages-container {
    flex: 1;
    overflow-y: auto;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.message {
    display: flex;
    gap: 1rem;
    max-width: 92%;
}

.message.user {
    align-self: flex-end;
    flex-direction: row-reverse;
}

/* Align items to bottom so copy button sits at bottom */
.message {
    align-items: flex-end;
}

.message-content {
    background-color: var(--bot-msg-bg);
    padding: 1rem;
    border-radius: 1rem;
    border-top-left-radius: 0;
    line-height: 1.5;
    font-size: 0.95rem;
    position: relative;
    min-width: 0;
    /* Fix for flex item overflow with pre tags */
}

.message.user .message-content {
    background-color: var(--user-msg-bg);
    border-radius: 1rem;
    border-top-right-radius: 0;
}

/* Copy Buttons */
.copy-btn {
    position: absolute;
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.4);
    cursor: pointer;
    font-size: 0.9rem;
    transition: opacity 0.2s, color 0.2s, background-color 0.2s;
    padding: 5px;
    border-radius: 4px;
    opacity: 0;
    /* Hide by default */
}

/* Show copy button when hovering the entire message row */
.message:hover .msg-copy-btn,
.message-content pre:hover .code-copy-btn {
    opacity: 1;
}

.copy-btn:hover {
    color: rgba(255, 255, 255, 0.9);
    background-color: rgba(255, 255, 255, 0.1);
}

.msg-copy-btn {
    position: static;
    color: var(--text-secondary);
    padding: 5px;
}

.code-copy-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    font-size: 0.8rem;
    background-color: rgba(0, 0, 0, 0.5);
    color: rgba(255, 255, 255, 0.6);
}

.input-area {
    padding: 1.5rem;
    background-color: rgba(15, 23, 42, 0.9);
    border-top: 1px solid var(--border-color);
    display: flex;
    gap: 1rem;
    align-items: flex-end;
}

#message-input {
    flex: 1;
    background-color: var(--input-bg);
    border: none;
    border-radius: 0.75rem;
    padding: 1rem;
    color: white;
    font-family: inherit;
    resize: none;
    max-height: 120px;
    outline: none;
}

.send-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 0.75rem;
    cursor: pointer;
    font-size: 1.2rem;
    transition: transform 0.1s;
}

.send-btn:active {
    transform: scale(0.95);
}

/* Modals */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 100;
}

.modal {
    background-color: var(--sidebar-bg);
    border-radius: 1rem;
    width: 90%;
    max-width: 500px;
    border: 1px solid var(--border-color);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
    max-height: 90dvh;
    display: flex;
    flex-direction: column;
}

.modal-header {
    padding: 1.25rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}

.modal-body {
    padding: 1.5rem;
    overflow-y: auto;
    flex: 1;
    min-height: 0;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    color: var(--text-secondary);
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    background-color: var(--input-bg);
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 0.75rem;
    color: white;
    font-family: inherit;
}

.form-group select option {
    background-color: var(--input-bg);
    color: white;
}

.form-group input:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--primary-color);
}

.modal-footer {
    padding: 1.25rem;
    border-top: 1px solid var(--border-color);
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    flex-shrink: 0;
}

.secondary-btn {
    background-color: transparent;
    border: 1px solid var(--border-color);
    color: var(--text-primary);
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.secondary-btn:hover {
    background-color: var(--border-color);
}

.hidden {
    display: none !important;
}

/* Markdown Styles within Message */
.message-content p {
    margin-bottom: 0.5em;
}

.message-content ul,
.message-content ol {
    margin-left: 1.5rem;
    margin-bottom: 0.5em;
}

.message-content>*:last-child {
    margin-bottom: -0.5rem;
}

.message-content pre {
    background-color: rgba(0, 0, 0, 0.3);
    padding: 0.5rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 0.5rem 0;
    position: relative;
}

.message-content a {
    color: #64b5f6;
    text-decoration: none;
    border-bottom: 1px dotted currentColor;
}

.message-content a:visited {
    color: #ce93d8;
}

.message-content a:hover {
    color: #90caf9;
    border-bottom-style: solid;
}


/* MCP Server List */
.mcp-server-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    max-height: 150px;
    overflow-y: auto;
    margin-bottom: 1rem;
    padding-right: 0.5rem;
}

.mcp-server-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: var(--input-bg);
    padding: 0.5rem 0.75rem;
    border-radius: 0.5rem;
    border: 1px solid var(--border-color);
}

.mcp-server-item span {
    font-size: 0.9rem;
    color: var(--text-primary);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-right: 0.5rem;
}

.mcp-server-item button {
    background: none;
    border: none;
    color: var(--danger-color);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: background-color 0.2s;
}

.mcp-server-item button:hover {
    background-color: rgba(239, 68, 68, 0.1);
}

.input-group-row {
    display: flex;
    gap: 0.5rem;
}

/* Tool Calls and Responses */
.tool-call,
.tool-response {
    background-color: rgba(0, 0, 0, 0.2);
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.85rem;
}

.tool-call summary,
.tool-response summary {
    cursor: pointer;
    font-weight: 500;
    color: var(--text-secondary);
    user-select: none;
    outline: none;
}

.tool-call summary:hover,
.tool-response summary:hover {
    color: var(--text-primary);
}

.tool-call pre,
.tool-response pre {
    margin: 0.5rem 0 0 0;
    font-size: 0.8rem;
    background-color: rgba(0, 0, 0, 0.3);
    padding: 0.5rem;
    border-radius: 0.25rem;
    overflow-x: auto;
    max-width: 100%;
    white-space: pre-wrap;
    /* Optional: Wrap text to avoid scroll if preferred, or keep pre for consistency */
}

/* Rich Media Display */
.chat-media-img {
    max-width: 100%;
    border-radius: 0.5rem;
    margin: 0.5rem 0;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    display: block;
}

.chat-media-video-wrapper {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%;
    /* 16:9 Aspect Ratio */
    height: 0;
    margin: 0.5rem 0;
    border-radius: 0.5rem;
    overflow: hidden;
    background: #000;
}

.chat-media-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}